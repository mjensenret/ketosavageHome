@model IEnumerable<KetoSavageWeb.ViewModels.UpdateMacrosViewModel>

@{ 
    var grid = Html.DevExpress().GridView(s =>
    {
        s.Name = "UpdateMacroGrid";
        s.CallbackRouteValues = new { Controller = "UserPrograms", Action = "NewMacrosGridview" };
        s.SettingsEditing.BatchUpdateRouteValues = new { Controller = "UserPrograms", Action = "BatchUpdateMacros" };
        s.SettingsEditing.Mode = GridViewEditingMode.Batch;
        s.SettingsEditing.BatchEditSettings.EditMode = GridViewBatchEditMode.Row;
        s.SettingsEditing.BatchEditSettings.StartEditAction = GridViewBatchStartEditAction.FocusedCellClick;

        s.SettingsBehavior.AllowSelectByRowClick = true;
        s.SettingsEditing.ShowModelErrorsForEditors = true;
        s.SettingsEditing.BatchEditSettings.ShowConfirmOnLosingChanges = true;
        s.SettingsBehavior.AllowFocusedRow = true;

        s.ClientSideEvents.BatchEditStartEditing = "OnStartEdit";
        s.ClientSideEvents.BatchEditEndEditing = "OnEndEdit";
        s.ClientSideEvents.BatchEditRowValidating = "OnValidateEdit";
        s.ClientSideEvents.SelectionChanged = "OnSelectionChanged";

        s.SettingsPager.Mode = GridViewPagerMode.ShowPager;
        s.SettingsPager.PageSize = 7;

        s.KeyFieldName = "Id";

        s.Columns.Add(c =>
        {
            c.FieldName = "Id";
            c.Visible = false;
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "Date";
            c.PropertiesEdit.DisplayFormatString = "d";
            c.ReadOnly = true;
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "WeekNum";
            c.ReadOnly = true;
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "WeekdayName";
            c.ReadOnly = true;
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "DateKey";
            c.Visible = false;
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "PlannedFat";
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "PlannedProtein";
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "PlannedCarbs";
        });
        s.Columns.Add(c =>
        {
            c.FieldName = "IsRefeed";
            c.Caption = "Refeed";
            c.ColumnType = MVCxGridViewColumnType.CheckBox;
        });
        s.CellEditorInitialize = (sender, e) =>
        {
            ASPxEdit editor = (ASPxEdit)e.Editor;
            editor.ValidationSettings.Display = Display.Dynamic;
        };
    });
}
@grid.Bind(Model).GetHtml()


